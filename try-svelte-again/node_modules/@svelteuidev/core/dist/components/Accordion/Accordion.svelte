<script generics="Multiple extends boolean = false">// Temporary eslint disable while svelte-eslint-parser does not support generics in file -->
/* eslint-disable no-undef */
import { createEventDispatcher, setContext } from 'svelte';
import { writable } from 'svelte/store';
import { randomID } from '../../styles';
import { Box } from '../Box';
import { key } from './key';
import Chevron from './Chevron/Chevron.svelte';
import useStyles from './Accordion.styles';
export let use = [], element = undefined, className = '', override = {}, variant = 'default', value = undefined, defaultValue = undefined, radius = 'sm', order = undefined, multiple = false, id = randomID(), chevron = Chevron, chevronPosition = 'right', chevronSize = 24, disableChevronRotation = false, transitionDuration = 200;
export { className as class };
const dispatch = createEventDispatcher();
let _value = value || defaultValue;
let stateContent = {
    variant,
    order,
    radius,
    chevron,
    chevronPosition,
    chevronSize,
    disableChevronRotation,
    transitionDuration,
    updateActive,
    isItemActive
};
const state = writable(stateContent);
// converts internal value into correct type
$: {
    if (multiple && !Array.isArray(_value)) {
        _value = (_value ? [_value] : []);
    }
}
// allows for reactivity to prop changes
$: {
    stateContent = {
        currentValue: _value,
        variant,
        order,
        radius,
        chevron,
        chevronPosition,
        chevronSize,
        disableChevronRotation,
        transitionDuration,
        updateActive,
        isItemActive,
        getControlsId,
        getRegionId
    };
    state.set(stateContent);
}
function updateActive(itemValue) {
    if (!multiple) {
        _value = (_value === itemValue ? undefined : itemValue);
        dispatch('change', _value);
        return;
    }
    let values = (_value || []);
    if (values.includes(itemValue)) {
        values = values.filter((v) => v !== itemValue);
    }
    else {
        values.push(itemValue);
    }
    _value = values;
    dispatch('change', _value);
}
function isItemActive(itemValue) {
    return multiple ? _value.includes(itemValue) : _value === itemValue;
}
function getControlsId(itemValue) {
    return `${id}-${itemValue}-panel`;
}
function getRegionId(itemValue) {
    return `${id}-${itemValue}-region`;
}
setContext(key, state);
$: ({ cx, classes, getStyles } = useStyles({ radius, variant }, { name: 'Accordion' }));
</script>

<!--
@component

Accordion component that allows the collapsing of each item.

@see https://svelteui.org/core/accordion
@example
    ```svelte
    <Accordion defaultValue="typescript">
      <Accordion.Item value="typescript">
        <div slot="control">Typescript Based</div>
        Content of the accordion item
      </Accordion.Item>
      <Accordion.Item value="packed" disabled>
        <div slot="control">Feature packed</div>
        ...
      </Accordion.Item>
      <Accordion.Item value="accessible">
        <div slot="control">Accessible and usable</div>
        ...
      </Accordion.Item>
    </Accordion>
    ```
-->

<Box
	class={cx(className, classes.root, getStyles({ css: override }))}
	bind:element
	{use}
	{...$$restProps}
>
	<slot />
</Box>
